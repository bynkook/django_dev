# Image Inspector - 이미지/도면 비교 기능

## 📋 프로젝트 개요

Image Inspector는 두 개의 이미지 또는 PDF 도면을 비교하여 차이점을 시각적으로 표시하는 웹 기반 도구입니다. 기존 Streamlit 기반 애플리케이션을 Django + FastAPI + React 아키텍처로 통합하여 구현했습니다.

**프로젝트 정보:**
- Branch: `feature/image-inspector`
- 개발 시작일: 2026년 1월 31일
- AI/LLM 사용: 없음 (독립적인 이미지 처리 기능)

---

## 🎯 주요 기능 및 작동 방법

### 1. 이미지 비교 시각화 (Visualization)

#### A. 2분할 차이점 강조 (Split View - Difference Mode)
메인 화면을 좌우 50:50으로 정확히 분할하여 두 이미지를 나란히 비교합니다.
- **왼쪽 패널 (File 1 - 기준 도면)**:
  - **🔵 파란색 하이라이트**: 기준 도면에만 존재하고 비교 도면에는 없는 요소 (삭제된 부분)를 시각적으로 강조
- **오른쪽 패널 (File 2 - 비교 도면)**:
  - **🔴 빨간색 하이라이트**: 비교 도면에만 새로 생긴 요소 (추가된 부분)를 시각적으로 강조
- **작동 방식**: 
  - 브라우저 창 크기에 맞춰 자동으로 이미지가 리사이즈(Fit to Width)됩니다.
  - 상단 범례를 통해 색상 의미를 즉시 파악할 수 있으며, PNG 다운로드 시에도 이 뷰가 유지됩니다.

#### B. 오버레이 뷰 (Overlay Mode)
두 이미지를 하나의 화면에 겹쳐서 표시합니다.
- **표시 방식**: 단일 화면에 두 이미지를 투명도를 조절하여 겹침
- **색상 구분**:
  - **🟠 주황색**: 1번 도면
  - **🟢 초록색**: 2번 도면
  - **혼합색**: 두 도면이 정확히 일치하는 부분 (검정/진한 색)

### 2. 다중 페이지 탐색 (Multi-page Navigation)
PDF 또는 다중 페이지 TIFF 파일 비교를 위한 네비게이션 시스템을 제공합니다.
- **위치**: 메인 결과 화면 최하단 (결과가 생성되고, 문서가 2페이지 이상일 때만 자동 표시)
- **독립적 제어**: File 1과 File 2의 페이지를 각각 독립적으로 넘길 수 있습니다.
  - 예: File 1의 3페이지 vs File 2의 5페이지 비교 가능
- **UI**: 
  - `<` (이전), `>` (다음) 화살표 버튼으로 이동
  - 현재 페이지 번호 / 전체 페이지 수 표시 (예: `3 / 10`)
  - 페이지 변경 시 즉시 새로운 비교 작업을 수행합니다.

### 3. 작업 초기화 (Reset Comparison)
새로운 작업을 빠르게 시작할 수 있는 원클릭 초기화 기능을 제공합니다.
- **위치**: 사이드바 상단 (파일 업로드 영역 위)
- **기능**:
  - 업로드된 모든 파일 제거
  - 선택된 페이지 정보 초기화 (0페이지로 리셋)
  - 화면에 표시된 비교 결과 제거
  - **디자인**: 하단의 비교 모드 버튼(활성화 상태)과 동일한 **파란색 테두리/배경 스타일**을 적용하여 시각적 통일성을 확보했습니다. (Hover 시 동일 디자인 적용)

### 4. 앱 선택 화면 (App Selector)
- **확장성 개선**: 메인 앱 선택 화면의 카드 크기를 기존 대비 80% 수준으로 축소하여, 향후 새로운 앱이 추가되더라도 레이아웃이 깨지지 않도록 공간 효율성을 높였습니다.

---

## 🏗️ 아키텍처 및 내부 로직

### 백엔드 처리 (FastAPI)
- **이미지 분리 반환**: 기존에는 합쳐진 결과 이미지 1장만 반환했으나, Split View 지원을 위해 3장(결과, 강조된 File1, 강조된 File2)을 반환하도록 로직 개선 (`generate_highlighted_images`)
- **페이지 정보 처리**: 파일 로드 시 전체 페이지 수를 메타데이터로 추출하여 프론트엔드에 전달

### 프론트엔드 구조 (React)
- **ResultViewer.jsx**: `mode` (difference/overlay)에 따라 레이아웃(Split/Single)을 동적으로 변경하는 조건부 렌더링 구현
- **ImageComparePage.jsx**: 페이지 상태(`page1`, `page2`)를 관리하고 하단 컨트롤러와 연동. `resetKey`를 사용하여 컴포넌트 완전 초기화 구현

---

## 🚀 실행 방법

### 1. 의존성 설치
```bash
# 가상환경 활성화
.venv\Scripts\activate

# Python 패키지 설치
pip install opencv-python==4.13.0.90 pymupdf==1.26.7 Pillow==12.1.0 numpy==2.3.5
```

### 2. 서버 실행
```bash
# 통합 실행 (추천)
run_project.bat
```

### 3. 접속 및 사용
1. 브라우저에서 `http://localhost:5173` 접속
2. **App Selector** 화면에서 **Image Inspector** 카드 클릭
3. **파일 업로드**:
   - 좌측 사이드바에 이미지 또는 PDF 2개 드래그 & 드롭
4. **설정 선택**:
   - 비교 모드 (차이점 강조 / 오버레이) 선택
   - 필요한 경우 임계값 조정
5. **[비교 시작]** 버튼 클릭
6. **결과 확인**:
   - 중앙 화면에서 비교 결과 확인
   - PDF인 경우 하단 화살표로 페이지 이동하며 검토
7. **새로운 작업**:
   - 사이드바 상단의 **"새로운 비교 초기화"** 버튼 클릭

---

## 👥 개발 정보
- **Branch**: feature/image-inspector
- **Latest Update**: 2026.01.31
- **주요 변경**: Split View 구현, 페이지 네비게이션 추가, UI 오버홀, 다중 페이지 PDF 지원 강화
